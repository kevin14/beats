extends admin_layout

block content
  h1!= title

  var url
  if title == "Edit"
    url = "/admin/content/edit/save"
  else 
    url = "/admin/content/add/save"
  
  form(action="{url}", method="post")
    
    h3 type
      select#type(name="form_type")
        option text 
        option video  

    h3 photo         
      input(id="files", type="file")
      br
      input(name="form_photo", type="text", placeholder="Image URL" value="#{post.photo}" class="background-image input-lg form-control")  
          
    
    
    h3.vidonly Video Id        
      input.vidonly(type="text" name="form_videoid" val="" placeholder="Ex: 30dk32l_21") 
      
    .lang  
      h3 English
      h4 Title:
      input(type="text" name="form_title_en" val="" placeholder="Compton") 
      h4.novid Text:
      textarea.novid(name="form_text_en" placeholder="Check out this article...")
      
    .lang  
      h3 French
      h4 Title:
      input(type="text" name="form_title_fr" val="" placeholder="Compton") 
      h4.novid Text:
      textarea.novid(name="form_text_fr" placeholder="Check out this article...")  
    
    .lang  
      h3 German
      h4 Title:
      input(type="text" name="form_title_de" val="" placeholder="Compton") 
      h4.novid Text:
      textarea.novid(name="form_text_de" placeholder="Check out this article...")  
    
    .lang  
      h3 Japanese
      h4 Title:
      input(type="text" name="form_title_jp" val="" placeholder="Compton") 
      h4.novid Text:
      textarea.novid(name="form_text_jp" placeholder="Check out this article...") 
    
    .lang  
      h3 Chinese Traditional
      h4 Title:
      input(type="text" name="form_title_ct" val="" placeholder="Compton") 
      h4.novid Text:
      textarea.novid(name="form_text_ct" placeholder="Check out this article...") 
        
    .lang  
      h3 Chinese Simplified
      h4 Title:
      input(type="text" name="form_title_cs" val="" placeholder="Compton") 
      h4.novid Text:
      textarea.novid(name="form_text_cs" placeholder="Check out this article...")  
    
    
    input(type="submit" value="Save Post")
      
  if post
    br
    br
    a.delete(href="/admin/content/delete/#{post.id}") Delete Forever!!!!!

  script(src="//code.jquery.com/jquery-1.11.3.min.js")
  script(src="//code.jquery.com/jquery-migrate-1.2.1.min.js")
  script(src="/js/s3upload.js")
  script.
    $(document).ready(function(){
    $(".vidonly").hide();
      $("#type").on("change", function(){
        if($( "#type option:selected" ).val() == "video") {
          $(".novid").hide();
          $(".vidonly").show();
        } else {
          $(".novid").show();
          $(".vidonly").hide();
        }
      });
    });
    
    (function() {
        var input_element = document.getElementById("files");
        input_element.onchange = s3_upload;
    })();



    function s3_upload(){
        //var status_elem = document.getElementById("status");
        //var url_elem = document.getElementById("avatar_url");
        //var preview_elem = document.getElementById("preview");
        var s3upload = new S3Upload({
            file_dom_selector: 'files',
            s3_sign_put_url: '/upload/sign_s3',
            s3_object_name: $("#files").val().split('\\').pop(),
            onProgress: function(percent, message) {
                console.log('Upload progress: ' + percent + '% ' + message);
                $(".background-image").val(percent+"%");
            },
            onFinishS3Put: function(public_url) {
                console.log(public_url);
                $(".background-image").val(public_url);
                
            },
            onError: function(status) {
                //status_elem.innerHTML = 'Upload error: ' + status;
                alert("upload error: " + status);
            }
        });
    }

    
    
